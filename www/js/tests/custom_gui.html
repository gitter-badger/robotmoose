<html lang="en">
	<head>
		<!--#include virtual="/sources.html"-->
		<!--#include virtual="/navbar.html"-->
	</head>
	<body role="document">
		<div style="padding-top: 51px;">
			<div id="gui"></div>
		</div>

		<script type="text/javascript">
			var robot_name="demo";
			var div=document.getElementById("gui");

			var robot_connect=new modal_connect_t(div);

			if(!robot_connect)
				alert("Could not create robot connect modal!");

			robot_connect.onconnect=function(robot_name)
			{
				console.log("CONNECT:  "+robot_name);
			};

			var menu=new robot_menu_t(div);

			if(!menu)
				alert("Could not create robot menu!");

			menu.status_area().innerHTML="<font style='color:red;'>Disconnected</font>";

			menu.create_button
			(
				"Robot",
				null,
				"glyphicon glyphicon-cog",
				{
					"Connect":
					{
						onclick:function()
						{
							robot_connect.robots=[];

							try
							{
								send_request("GET","/superstar/","/","?get",
									function(response)
									{
										robot_connect.robots=[];
										robot_connect.robots=JSON.parse(response);
										robot_connect.show();
									},
									function(error)
									{
										throw error;
									},
									"application/json");
							}
							catch(error)
							{
								console.log("Robot Connect - "+error);
							}
						},
						glyph:"glyphicon glyphicon-off"
					},
					"Make a Copy":
					{
						onclick:function(){alert("Copy!");},
						glyph:"glyphicon glyphicon-duplicate"
					}
				}
			);

			var gui=new doorways_t(div);

			if(!gui)
				alert("Could not create gui!");

			gui.load([{"title":"Configuration","x":460,"y":240,"active":false,"minimized":true},
				{"title":"States","x":1000,"y":0,"active":false,"minimized":true}]);

			if(!gui.get_window("Configuration"))
				gui.create_window("Configuration",10,0);

			var config_editor=new config_editor_t(gui.get_window("Configuration").body.content,robot_name);

			if(!config_editor)
				alert("Could not create config editor!");

			config_editor.onrefresh=function(){gui.refresh_windows_m();};
			config_editor.onconfigure=function(){alert("CONFIGURE!");}

			if(!gui.get_window("States"))
				gui.create_window("States",0,0);

			var state_table=new state_table_t(gui.get_window("States").body.content);
			state_table.onrefresh=function(){gui.refresh_windows_m();};
			state_table.onrun=function(){alert("RUN!");}

			if(!state_table)
				alert("Could not create state table!");

			state_table.create_entry("drive","// Drive forward:\nif (robot.location.x<10) \n  robot.drive(100,100); \nelse \n  robot.state=turn; \n");
			state_table.create_entry("turn","// Turn left:\nif (robot.location.angle<90)\n  robot.drive(-100,100); \nelse  \n  robot.state=forward; \n");
		</script>
	</body>
</html>
