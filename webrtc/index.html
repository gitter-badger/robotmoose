<!DOCTYPE html>
<html style="margin:0px;padding:0px;width:100%;height:100%;">
	<head>
		<script src="latest.js"></script>
		<script src="http://robotmoose.com/js/input_validation.js"></script>
		<script src="http://robotmoose.com/js/uri.js"></script>
		<script src="http://robotmoose.com/js/utility.js"></script>
		<script src="http://robotmoose.com/js/xmlhttp.js"></script>

		<!--<div id="remote_div" style="margin:0px;padding:0px;width:100%;height:100%;overflow:hidden;"></div>-->
		<div id="outer_div" style="margin:0px;padding:0px;width:100%;height:100%;overflow:hidden;"></div>

		<style>
			head
			{
				overflow:none;
				margin:0px;
				padding:0px;
				width:100%;
				height:100%;
			}

			body
			{
				overflow:none;
				margin:0px;
				padding:0px;
				width:100%;
				height:100%;
			}
		</style>

		<script>
			//onclick - function to call when clicked.
			function hover_div_t(div,side)
			{
				if(!div)
					return null;

				this.div=div;
				var myself=this;

				this.el=document.createElement("div");
				this.el.style.top=0;
				this.el.style.float=side;
				this.el.style.margin=this.el.style.padding="0px";
				this.el.style.width="100px";
				this.el.style.height="100%";
				this.el.style.backgroundColor="black";
				this.el.style.opacity=0.1;
				this.el.style.cursor="pointer";
				this.el.onclick=function(){if(myself.onclick)myself.onclick();}
				this.el.onmouseenter=function(){myself.el.style.opacity=0.5;}
				this.el.onmouseleave=function(){myself.el.style.opacity=0.1;}
				this.div.appendChild(this.el);
			}

			hover_div_t.prototype.remove=function()
			{
				this.div.removeChild(this.el);
			}

			function video_hide(index)
			{
				//objs[index].v.style.height="0px";
				//objs[index].v.style.visibility="hidden";
			}

			function video_show(index)
			{
				/*if(index<objs.length&&index>=0)
				{
					objs[index].v.style.height="100%";
					objs[index].v.style.visibility="visible";
				}*/
			}

			function video_hide_all()
			{
				//for(var ii=0;ii<objs.length;++ii)
				//	video_hide(ii);
			}

			function create_video(video,peer)
			{
				/*if(uri.doorways)
					outer_div.style.height=remote_div.style.height="90%";

				remote_div.style.backgroundColor="white";
				video.style.position="absolute";
				video.style.top=video.style.height=video.style.padding=video.style.margin="0px";
				video.style.left="0px";
				video.style.width="100%";
				video.style.visibility="hidden";
				var obj={};
				obj.p=peer;
				obj.v=video;
				objs.push(obj);

				if(objs.length==1)
					video_show(0);*/
			}

			function remove_video(video,peer)
			{
				/*var new_objs=[];

				for(var key in objs)
					if(objs[key].p===peer)
						objs[key]=undefined;
					else
						new_objs.push(objs[key]);

				objs=new_objs;

				if(objs.length==0)
					remote_div.style.backgroundColor="red";

				while(index>=objs.length&&index>0)
					--index;

				video_show(index);*/
			}

			var outer_div=document.getElementById("outer_div");
			outer_div.style.position="absolute";
			outer_div.style.top=0;

			/*var remote_div=document.getElementById("remote_div");
			remote_div.style.position="absolute";
			remote_div.style.top=0;
			remote_div.style.pointerEvents="none";
			remote_div.style.verticalAlign="middle";*/

			//var uri=parse_uri(location.search);
			var index=0;
			var objs=[];

			var left_hover=new hover_div_t(outer_div,"left");
			left_hover.onclick=function()
			{
				if(index-1>=0)
					--index;
				else if(objs.length>0)
					index=objs.length-1;

				video_hide_all();

				video_show(index);
			};
			var right_hover=new hover_div_t(outer_div,"right");
			right_hover.onclick=function()
			{
				if(index+1<objs.length)
					++index;
				else if(objs.length>0)
					index=0;

				video_hide_all();
				video_show(index);
			};

			/*var webrtc=new SimpleWebRTC
			({
				localVideoEl:null,
				remoteVideosEl:remote_div,
				autoRequestMedia:true,
				peerConnectionConfig:
				{
					iceServers:
					[
						{"url": "stun:stun.l.google.com:19302"},
						{"url": "stun:robotmoose.com:3478"}
					]
				},
				localVideo:
				{
					mirror:false
				},
			});

			validate_robot_name(uri.robot,
				function()
				{
					webrtc.on('videoAdded',create_video);
					webrtc.on('videoRemoved',remove_video);
					webrtc.on('readyToCall',function(){webrtc.joinRoom(uri.robot);});
				},
				function()
				{
					console.log("Invalid robot name \""+uri.robot+"\".");
				});*/
		</script>
	</head>
	<body>
	</body>
</html>
