%! encoderdisk.ps
%  I. J. Stefanov-Wagner, 2004.07.07
%  for making quadrature encoder disks
%  based on StarTestChart.ps
%  based on VossClock; Ishmael, 25mar92
%  Put up a calibrated rotary instrument face
%  Remember, page is 612 wide by 792 high
%  Rotary Encoder disk pattern; PJN, 18 Feb 2010
%  Original test pattern: ijs (atsign) epl.meei.harvard.edu
%  Released under Creative Commons license, attribution, non-commercial; see
%  http://creativecommons.org/licenses/by-nc/3.0/


/inch { 72 mul } def
/mm   { 2.83 mul } def

% units below are in points unless qualified, that is
% 144 , 2 inch , 51 mm are roughly equivalent
% Default values were radius=100, stripewidth=25
% PJN: The following values are for the Venom Creeper Wheel rims (inner rim)
/diskradius 89 def	% center to outer edge of pattern
/stripewidth 25 def	% inside to outside of ring

% The number of segments is dictated by the optical resolution of the sensor.
% I'm using the Fairchild QRB1134, which has an optimal visual diameter of
% 5mm at 5mm distance. More than 64 segments results in problematic counting.
/segments 64 def	% number of cycles per rev

/doublestripe true def	% true for double (quad) pattern
/doublestripe false def

% If doublestripe is true, will print a second ring in
% quadrature so that it can be used by sensors in-line
% rather than offset for easy change of resolution.

306 396 translate	% prints pattern in center of page
/xo 0 def
/yo 0 def

/outradius diskradius def
/inradius outradius stripewidth sub def

/step 360 segments div def
/halfstep step 2 div def
/quadstep step 4 div def

0 step 359 { /angle exch def
	/hangle angle halfstep add def
	newpath
	xo yo outradius angle hangle arc
	xo yo inradius hangle angle arcn
	closepath fill
	} for

doublestripe {

    /outradius inradius def
    /inradius outradius stripewidth sub def

    0 step 359 { /angle exch quadstep add def
	/hangle angle halfstep add def
	newpath
	xo yo outradius angle hangle arc
	xo yo inradius hangle angle arcn
	closepath fill
	} for
    } if

newpath
0.5 setlinewidth
0 inradius moveto 0 inradius neg lineto
inradius neg 0 moveto inradius 0 lineto
stroke

showpage
